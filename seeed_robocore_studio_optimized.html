<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seeed RoboCore Studio - Optimized</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --seeed-green: #00D5A4;
            --seeed-dark: #1A1A2E;
            --seeed-light: #F5F5F5;
            --primary-color: #00D5A4;
            --secondary-color: #FF6B6B;
            --accent-color: #4ECDC4;
            --background-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --card-bg: rgba(255, 255, 255, 0.95);
            --border-radius: 12px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--background-gradient);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        .main-container {
            display: grid;
            grid-template-columns: 320px 1fr 380px;
            grid-template-rows: auto 1fr;
            gap: 15px;
            height: 100vh;
            padding: 15px;
        }

        /* é¡¶éƒ¨å“ç‰Œæ  */
        .brand-header {
            grid-column: 1 / -1;
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 15px 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .brand-title {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .brand-logo {
            width: 40px;
            height: 40px;
            background: var(--seeed-green);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
            font-weight: bold;
        }

        .brand-title h1 {
            background: linear-gradient(135deg, #00D5A4 0%, #4ECDC4 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 1.8rem;
            font-weight: 700;
            margin: 0;
        }

        .connection-status {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
            padding: 8px 15px;
            background: #F8F9FA;
            border-radius: 8px;
            border: 1px solid #E9ECEF;
        }

        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--secondary-color);
            animation: pulse 2s infinite;
            transition: var(--transition);
        }

        .status-indicator.connected {
            background: var(--seeed-green);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.1); }
        }

        /* é¢æ¿åŸºç¡€æ ·å¼ */
        .panel {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .panel:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .panel-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid #E9ECEF;
            flex-shrink: 0;
        }

        .panel-title {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.95rem;
            font-weight: 600;
            color: #2D3748;
        }

        .panel-icon {
            width: 22px;
            height: 22px;
            background: linear-gradient(135deg, var(--seeed-green), var(--accent-color));
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
        }

        /* å·¦ä¾§é¢æ¿ - è®¾å¤‡ç®¡ç† */
        .left-panel {
            grid-row: 2;
        }

        /* ä¸­é—´é¢æ¿ - ä¸»è¦å†…å®¹ */
        .center-panel {
            grid-row: 2;
        }

        /* å³ä¾§é¢æ¿ - æ—¥å¿— */
        .right-panel {
            grid-row: 2;
        }

        /* å¿«é€Ÿæ“ä½œæŒ‰é’® */
        .quick-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 12px;
        }

        .button {
            background: var(--seeed-green);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            box-shadow: 0 4px 12px rgba(0, 213, 164, 0.3);
        }

        .button:hover {
            background: #00B894;
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(0, 213, 164, 0.4);
        }

        .button.danger {
            background: var(--secondary-color);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);
        }

        .button.danger:hover {
            background: #FF5252;
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
        }

        .button.warning {
            background: #F59E0B;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
        }

        .button.warning:hover {
            background: #D97706;
            box-shadow: 0 6px 20px rgba(245, 158, 11, 0.4);
        }

        /* æ‰«æçŠ¶æ€ */
        .scan-status {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 10px;
            background: #F0F9FF;
            border: 1px solid #BAE6FD;
            border-radius: 4px;
            font-size: 0.7rem;
            color: #0369A1;
            margin-bottom: 8px;
            flex-shrink: 0;
        }

        .loading {
            width: 14px;
            height: 14px;
            border: 2px solid #E0E0E0;
            border-radius: 50%;
            border-top-color: var(--seeed-green);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* è®¾å¤‡åˆ—è¡¨ */
        .servo-list {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 8px;
            overflow-x: hidden;
        }

        .servo-item {
            background: #F8F9FA;
            border: 2px solid #E9ECEF;
            border-radius: 6px;
            padding: 8px;
            margin-bottom: 6px;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
        }

        .servo-item:hover {
            background: #E8F5E8;
            border-color: var(--seeed-green);
            transform: translateX(2px);
        }

        .servo-item.selected {
            background: #E8F5E8;
            border-color: var(--seeed-green);
        }

        .servo-id {
            font-size: 0.85rem;
            font-weight: 700;
            color: #2D3748;
            margin-bottom: 3px;
        }

        .servo-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.7rem;
            color: #718096;
            margin-bottom: 3px;
        }

        .servo-details {
            font-size: 0.65rem;
            color: #A0AEC0;
            display: flex;
            gap: 6px;
        }

        .servo-detail-item {
            display: flex;
            align-items: center;
            gap: 2px;
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #28A745;
        }

        /* æ ‡ç­¾å¯¼èˆª */
        .tab-container {
            display: flex;
            background: #F8F9FA;
            border-radius: 6px;
            padding: 2px;
            margin-bottom: 12px;
            border: 1px solid #E9ECEF;
            flex-shrink: 0;
        }

        .tab {
            flex: 1;
            padding: 6px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            color: #718096;
            background: transparent;
            transition: var(--transition);
            font-size: 0.7rem;
        }

        .tab:hover {
            background: rgba(0, 213, 164, 0.1);
        }

        .tab.active {
            background: var(--seeed-green);
            color: white;
            box-shadow: 0 2px 8px rgba(0, 213, 164, 0.3);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
            flex: 1;
            overflow-y: auto;
            min-height: 0;
        }

        .tab-content.active {
            display: flex;
            flex-direction: column;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* æ§åˆ¶ç»„ä»¶ */
        .control-group {
            margin-bottom: 12px;
        }

        .control-group label {
            display: block;
            margin-bottom: 4px;
            font-weight: 600;
            color: #2D3748;
            font-size: 0.75rem;
        }

        .control-group input, .control-group select {
            width: 100%;
            padding: 6px 10px;
            border: 1px solid #CBD5E0;
            border-radius: 4px;
            font-size: 0.75rem;
            transition: var(--transition);
            background: white;
        }

        .control-group input:focus, .control-group select:focus {
            outline: none;
            border-color: var(--seeed-green);
            box-shadow: 0 0 0 3px rgba(0, 213, 164, 0.1);
        }

        /* æ»‘å—æ ·å¼ */
        .slider-container {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .slider {
            flex: 1;
            -webkit-appearance: none;
            appearance: none;
            height: 5px;
            border-radius: 3px;
            background: #E9ECEF;
            outline: none;
            transition: var(--transition);
        }

        .slider:hover {
            background: #DEE2E6;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--seeed-green);
            cursor: pointer;
            transition: var(--transition);
        }

        .slider::-webkit-slider-thumb:hover {
            background: #00B894;
            transform: scale(1.1);
        }

        .slider-value {
            min-width: 45px;
            text-align: center;
            font-weight: 600;
            color: var(--seeed-green);
            background: #E8F5E8;
            padding: 3px 6px;
            border-radius: 3px;
            border: 1px solid var(--seeed-green);
            font-size: 0.7rem;
        }

        /* å†…å­˜è¡¨æ ¼ */
        .memory-table-container {
            flex: 1;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .memory-table-header {
            display: grid;
            grid-template-columns: 55px 130px 180px 130px 70px 85px 70px;
            gap: 6px;
            padding: 8px;
            background: #F8F9FA;
            border: 1px solid #E9ECEF;
            border-radius: 5px;
            font-weight: 600;
            font-size: 0.7rem;
            color: #2D3748;
            margin-bottom: 6px;
            flex-shrink: 0;
        }

        .memory-table-body {
            flex: 1;
            overflow-y: auto;
            border: 1px solid #E9ECEF;
            border-radius: 6px;
        }

        .memory-row {
            display: grid;
            grid-template-columns: 55px 130px 180px 130px 70px 85px 70px;
            gap: 6px;
            padding: 6px;
            border-bottom: 1px solid #F0F0F0;
            align-items: center;
            transition: var(--transition);
            font-size: 0.7rem;
        }

        .memory-row:hover {
            background: #F8F9FA;
        }

        .memory-row.eeprom {
            background: #FFF7ED;
        }

        .memory-row.eeprom:hover {
            background: #FED7AA;
        }

        .memory-row.ram {
            background: #F0F9FF;
        }

        .memory-row.ram:hover {
            background: #BAE6FD;
        }

        .memory-address {
            font-weight: 600;
            color: #4A5568;
        }

        .memory-name {
            color: #2D3748;
        }

        .memory-description {
            color: #718096;
            font-size: 0.65rem;
        }

        .memory-type {
            font-size: 0.65rem;
            padding: 2px 4px;
            border-radius: 3px;
            text-align: center;
        }

        .memory-type.eeprom {
            background: #ED8936;
            color: white;
        }

        .memory-type.ram {
            background: #4299E1;
            color: white;
        }

        .memory-access {
            font-size: 0.65rem;
            padding: 2px 4px;
            border-radius: 3px;
            text-align: center;
        }

        .memory-access.rw {
            background: #48BB78;
            color: white;
        }

        .memory-access.ro {
            background: #E53E3E;
            color: white;
        }

        .memory-value {
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
            font-weight: 600;
            color: #2D3748;
            font-size: 0.65rem;
        }

        .memory-actions {
            display: flex;
            gap: 3px;
        }

        .mini-button {
            padding: 3px 5px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.6rem;
            transition: var(--transition);
        }

        .mini-button.read {
            background: #4299E1;
            color: white;
        }

        .mini-button.read:hover {
            background: #3182CE;
        }

        .mini-button.write {
            background: #48BB78;
            color: white;
        }

        .mini-button.write:hover {
            background: #38A169;
        }

        /* çŠ¶æ€æ˜¾ç¤º */
        .status-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }

        .status-item {
            background: #F8F9FA;
            border: 1px solid #E9ECEF;
            border-radius: 6px;
            padding: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .status-label {
            font-size: 0.8rem;
            color: #718096;
        }

        .status-value {
            font-weight: 600;
            color: #2D3748;
        }

        /* æ—¥å¿— */
        .log-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .log-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
            flex-shrink: 0;
        }

        .log {
            background: var(--seeed-dark);
            color: #E2E8F0;
            border-radius: 8px;
            padding: 12px;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
            font-size: 0.75rem;
            overflow-y: auto;
            white-space: pre-wrap;
            flex: 1;
        }

        .log-entry {
            margin-bottom: 2px;
            padding: 1px 0;
            border-left: 2px solid transparent;
            padding-left: 6px;
        }

        .log-entry:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .log-entry.info { color: #63B3ED; border-left-color: #63B3ED; }
        .log-entry.success { color: #68D391; border-left-color: #68D391; }
        .log-entry.warning { color: #F6E05E; border-left-color: #F6E05E; }
        .log-entry.error { color: #FC8181; border-left-color: #FC8181; }

        /* ç©ºçŠ¶æ€ */
        .empty-state {
            text-align: center;
            padding: 15px;
            color: #718096;
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .empty-icon {
            font-size: 1.5rem;
            margin-bottom: 8px;
            opacity: 0.5;
        }

        .empty-title {
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .empty-description {
            font-size: 0.7rem;
            line-height: 1.4;
        }

        /* æ ‡å®šé€‰æ‹©å™¨ */
        .calibration-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 15px;
        }

        .calibration-card {
            background: white;
            border: 2px solid #E9ECEF;
            border-radius: 8px;
            padding: 12px;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
        }

        .calibration-card:hover {
            border-color: var(--seeed-green);
            background: #F0FDF4;
        }

        .calibration-card.active {
            border-color: var(--seeed-green);
            background: #E8F5E8;
        }

        .cal-icon {
            font-size: 1.5rem;
            margin-bottom: 4px;
        }

        .cal-title {
            font-weight: 600;
            color: #2D3748;
            margin-bottom: 2px;
            font-size: 0.85rem;
        }

        .cal-description {
            font-size: 0.7rem;
            color: #718096;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1400px) {
            .main-container {
                grid-template-columns: 280px 1fr 320px;
            }
        }

        @media (max-width: 1200px) {
            .main-container {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto 1fr auto;
            }

            .left-panel,
            .right-panel {
                grid-row: auto;
            }
        }

        /* æ‰‹åŠ¨æ ¡å‡†æ¨¡å¼ */
        .manual-mode {
            background: #FFF7ED;
            border: 2px solid #FED7AA;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 15px;
        }

        .manual-mode-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            color: #EA580C;
            font-weight: 600;
            font-size: 0.85rem;
        }

        .torque-button {
            background: #F59E0B;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            font-size: 0.8rem;
        }

        .torque-button:hover {
            background: #D97706;
        }

        .torque-button.active {
            background: #DC2626;
        }

        /* å¿«é€Ÿé¢„è®¾æŒ‰é’® */
        .preset-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 6px;
        }

        .preset-button {
            background: white;
            border: 1px solid #CBD5E0;
            border-radius: 6px;
            padding: 8px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.8rem;
        }

        .preset-button:hover {
            border-color: var(--seeed-green);
            background: #E8F5E8;
        }

        /* è¡¨æ ¼æœç´¢è¿‡æ»¤ */
        .table-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .search-input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #CBD5E0;
            border-radius: 6px;
            font-size: 0.8rem;
        }

        .filter-button {
            padding: 8px 12px;
            background: white;
            border: 1px solid #CBD5E0;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: var(--transition);
        }

        .filter-button.active {
            background: var(--seeed-green);
            color: white;
            border-color: var(--seeed-green);
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- é¡¶éƒ¨å“ç‰Œæ  -->
        <div class="brand-header">
            <div class="brand-title">
                <div class="brand-logo">S</div>
                <h1>Seeed RoboCore Studio</h1>
            </div>
            <div class="connection-status">
                <div class="status-indicator" id="statusIndicator"></div>
                <span id="connectionStatus">æ­£åœ¨è¿æ¥æœåŠ¡å™¨...</span>
            </div>
        </div>

        <!-- å·¦ä¾§é¢æ¿ - è®¾å¤‡ç®¡ç† -->
        <div class="panel left-panel">
            <div class="panel-header">
                <div class="panel-title">
                    <div class="panel-icon">ğŸ”§</div>
                    <span>è®¾å¤‡ç®¡ç†</span>
                </div>
            </div>

            <!-- å¿«é€Ÿæ“ä½œ -->
            <div class="quick-actions">
                <button class="button" onclick="scanServos()">
                    <span>ğŸ”</span> é‡æ–°æ‰«æ
                </button>
                <button class="button warning" onclick="startCalibration()">
                    <span>âš™ï¸</span> è®¾å¤‡æ ‡å®š
                </button>
            </div>

            <!-- æ‰«æçŠ¶æ€ -->
            <div id="scanStatus" style="display: none;" class="scan-status">
                <div class="loading"></div>
                <span>æ­£åœ¨æ‰«æè®¾å¤‡...</span>
            </div>

            <!-- è®¾å¤‡åˆ—è¡¨ -->
            <div class="servo-list" id="servoList">
                <div class="empty-state">
                    <div class="empty-icon">ğŸ¤–</div>
                    <div class="empty-title">æœªå‘ç°è®¾å¤‡</div>
                    <div class="empty-description">ç‚¹å‡»"é‡æ–°æ‰«æ"æŒ‰é’®æ¥æœç´¢è¿æ¥çš„èˆµæœº</div>
                </div>
            </div>
        </div>

        <!-- ä¸­é—´é¢æ¿ - ä¸»è¦å†…å®¹ -->
        <div class="panel center-panel">
            <div class="panel-header">
                <div class="panel-title">
                    <div class="panel-icon">ğŸ›ï¸</div>
                    <span>æ§åˆ¶ä¸­å¿ƒ</span>
                </div>
            </div>

            <!-- æ ‡ç­¾å¯¼èˆª -->
            <div class="tab-container">
                <button class="tab active" onclick="switchTab('control')">å®æ—¶æ§åˆ¶</button>
                <button class="tab" onclick="switchTab('memory')">å†…å­˜è¡¨æ ¼</button>
                <button class="tab" onclick="switchTab('calibration')">è®¾å¤‡æ ‡å®š</button>
            </div>

            <!-- å®æ—¶æ§åˆ¶æ ‡ç­¾é¡µ -->
            <div id="control-tab" class="tab-content active">
                <div id="controlPanel">
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ®</div>
                        <div class="empty-title">è¯·é€‰æ‹©è®¾å¤‡</div>
                        <div class="empty-description">ä»å·¦ä¾§è®¾å¤‡åˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªèˆµæœºå¼€å§‹æ§åˆ¶</div>
                    </div>
                </div>
            </div>

            <!-- å†…å­˜è¡¨æ ¼æ ‡ç­¾é¡µ -->
            <div id="memory-tab" class="tab-content">
                <div class="memory-table-container">
                    <!-- è¡¨æ ¼æ§åˆ¶ -->
                    <div class="table-controls">
                        <input type="text" class="search-input" placeholder="æœç´¢å†…å­˜åœ°å€æˆ–åç§°..." oninput="filterMemoryTable(this.value)">
                        <button class="filter-button active" onclick="filterMemoryType('all')">å…¨éƒ¨</button>
                        <button class="filter-button" onclick="filterMemoryType('eeprom')">EEPROM</button>
                        <button class="filter-button" onclick="filterMemoryType('ram')">RAM</button>
                    </div>

                    <!-- è¡¨æ ¼å¤´éƒ¨ -->
                    <div class="memory-table-header">
                        <div>åœ°å€</div>
                        <div>åç§°</div>
                        <div>æè¿°</div>
                        <div>ç±»å‹</div>
                        <div>è®¿é—®</div>
                        <div>å½“å‰å€¼</div>
                        <div>æ“ä½œ</div>
                    </div>

                    <!-- è¡¨æ ¼å†…å®¹ -->
                    <div class="memory-table-body" id="memoryTableBody">
                        <!-- åŠ¨æ€ç”Ÿæˆå†…å®¹ -->
                    </div>
                </div>
            </div>

            <!-- è®¾å¤‡æ ‡å®šæ ‡ç­¾é¡µ -->
            <div id="calibration-tab" class="tab-content">
                <div id="calibrationPanel">
                    <!-- æ ‡å®šé¡¹ç›®é€‰æ‹©å™¨ -->
                    <div class="calibration-selector">
                        <div class="calibration-card" id="cal-id" onclick="selectCalibrationType('id')">
                            <div class="cal-icon">ğŸ·ï¸</div>
                            <div class="cal-title">IDé…ç½®</div>
                            <div class="cal-description">è®¾ç½®èˆµæœºID</div>
                        </div>
                        <div class="calibration-card" id="cal-temp" onclick="selectCalibrationType('temperature')">
                            <div class="cal-icon">ğŸŒ¡ï¸</div>
                            <div class="cal-title">æ¸©åº¦é™åˆ¶</div>
                            <div class="cal-description">æ¸©åº¦ä¿æŠ¤é˜ˆå€¼</div>
                        </div>
                        <div class="calibration-card" id="cal-center" onclick="selectCalibrationType('center')">
                            <div class="cal-icon">ğŸ¯</div>
                            <div class="cal-title">ä¸­ä½æ ¡å‡†</div>
                            <div class="cal-description">æ‰‹åŠ¨æ ¡å‡†ä¸­ä½</div>
                        </div>
                    </div>

                    <!-- æ ‡å®šå†…å®¹åŒºåŸŸ -->
                    <div id="calibrationContent">
                        <div class="empty-state">
                            <div class="empty-icon">ğŸ¯</div>
                            <div class="empty-title">é€‰æ‹©æ ‡å®šé¡¹ç›®</div>
                            <div class="empty-description">ç‚¹å‡»ä¸Šæ–¹æ ‡å®šå¡ç‰‡å¼€å§‹å…·ä½“çš„æ ‡å®šæ“ä½œ</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- å³ä¾§é¢æ¿ - æ—¥å¿—å’ŒçŠ¶æ€ -->
        <div class="panel right-panel">
            <!-- çŠ¶æ€æ˜¾ç¤º -->
            <div class="panel-header">
                <div class="panel-title">
                    <div class="panel-icon">ğŸ“Š</div>
                    <span>çŠ¶æ€ç›‘æ§</span>
                </div>
            </div>

            <div id="statusPanel" style="margin-bottom: 15px;">
                <div class="empty-state">
                    <div class="empty-icon">ğŸ“ˆ</div>
                    <div class="empty-title">é€‰æ‹©è®¾å¤‡æŸ¥çœ‹çŠ¶æ€</div>
                    <div class="empty-description">è®¾å¤‡çŠ¶æ€ä¿¡æ¯å°†åœ¨æ­¤å¤„æ˜¾ç¤º</div>
                </div>
            </div>

            <!-- ç³»ç»Ÿæ—¥å¿— -->
            <div class="log-container">
                <div class="log-header">
                    <div class="panel-title">
                        <div class="panel-icon">ğŸ“</div>
                        <span>ç³»ç»Ÿæ—¥å¿—</span>
                    </div>
                    <button class="mini-button" onclick="clearLog()" style="font-size: 0.7rem;">æ¸…ç©º</button>
                </div>
                <div class="log" id="logContent">
                    <div class="log-entry info">[ç³»ç»Ÿ] Seeed RoboCore Studio åˆå§‹åŒ–å®Œæˆ</div>
                    <div class="log-entry info">[ç³»ç»Ÿ] æ­£åœ¨è¿æ¥æœåŠ¡å™¨...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class SeeedRoboCoreController {
            constructor() {
                this.ws = null;
                this.selectedServoId = null;
                this.reconnectAttempts = 0;
                this.maxReconnectAttempts = 5;
                this.calibrationData = {
                    servoId: null,
                    temperatureLimit: 75,
                    centerPosition: 2048
                };

                // å®æ—¶æ§åˆ¶ç›¸å…³å˜é‡
                this.controlMode = 'manual';
                this.realtimeEnabled = false;
                this.lastMoveTime = 0;
                this.moveDebounceDelay = 50;

                // å†…å­˜æ•°æ®
                this.memoryData = new Map();

                this.init();
            }

            init() {
                this.connect();
                this.addLog('[ç³»ç»Ÿ] Seeed RoboCore Studio åˆå§‹åŒ–å®Œæˆ', 'success');
                this.addLog('[ç³»ç»Ÿ] æ­£åœ¨è¿æ¥æœåŠ¡å™¨...', 'info');

                // åˆå§‹åŒ–å†…å­˜è¡¨æ ¼æ•°æ®
                this.initializeMemoryTable();
            }

            connect() {
                this.ws = new WebSocket('ws://localhost:8765');

                this.ws.onopen = () => {
                    this.addLog('[WebSocket] æœåŠ¡å™¨è¿æ¥æˆåŠŸ', 'success');
                    this.updateConnectionStatus(true);
                    this.reconnectAttempts = 0;
                };

                this.ws.onmessage = (event) => {
                    const message = JSON.parse(event.data);
                    this.handleMessage(message);
                };

                this.ws.onclose = () => {
                    this.addLog('[WebSocket] è¿æ¥æ–­å¼€', 'warning');
                    this.updateConnectionStatus(false);
                    this.attemptReconnect();
                };

                this.ws.onerror = (error) => {
                    this.addLog(`[WebSocket] è¿æ¥é”™è¯¯: ${error}`, 'error');
                    this.updateConnectionStatus(false);
                };
            }

            attemptReconnect() {
                if (this.reconnectAttempts < this.maxReconnectAttempts) {
                    this.reconnectAttempts++;
                    this.addLog(`[ç³»ç»Ÿ] å°è¯•é‡è¿ (${this.reconnectAttempts}/${this.maxReconnectAttempts})`, 'info');
                    setTimeout(() => this.connect(), 3000);
                } else {
                    this.addLog('[ç³»ç»Ÿ] è¾¾åˆ°æœ€å¤§é‡è¿æ¬¡æ•°', 'error');
                }
            }

            handleMessage(message) {
                switch (message.type) {
                    case 'connection':
                        this.handleConnection(message);
                        break;
                    case 'scan_result':
                        this.handleScanResult(message);
                        break;
                    case 'servo_status':
                        this.handleServoStatus(message);
                        break;
                    case 'move_result':
                        this.handleMoveResult(message);
                        break;
                    case 'memory_read':
                        this.handleMemoryRead(message);
                        break;
                    case 'firmware_info':
                        this.handleFirmwareInfo(message);
                        break;
                    case 'pid_params':
                        this.handlePidParams(message);
                        break;
                    case 'temperature_limit_read':
                        this.handleTemperatureLimit(message);
                        break;
                    case 'servo_id_set_result':
                        this.handleServoIdSetResult(message);
                        break;
                    case 'error':
                        this.addLog(`[æœåŠ¡å™¨] é”™è¯¯: ${message.message}`, 'error');
                        break;
                    default:
                        this.addLog(`[ç³»ç»Ÿ] æœªçŸ¥æ¶ˆæ¯ç±»å‹: ${message.type}`, 'warning');
                }
            }

            initializeMemoryTable() {
                // FTServo å¢å¼ºç‰ˆå†…å­˜æ˜ å°„è¡¨ (åŸºäºé€†å‘å·¥ç¨‹åˆ†æ)
                const memoryMap = [
                    // EPROMåŒºåŸŸ - å›ºä»¶ä¿¡æ¯ (åªè¯»)
                    { address: 0, name: "å›ºä»¶ä¸»ç‰ˆæœ¬", description: "èˆµæœºå›ºä»¶ä¸»è¦ç‰ˆæœ¬å·", type: "EEPROM", access: "RO", defaultValue: 3 },
                    { address: 1, name: "å›ºä»¶å‰¯ç‰ˆæœ¬", description: "èˆµæœºå›ºä»¶æ¬¡è¦ç‰ˆæœ¬å·", type: "EEPROM", access: "RO", defaultValue: 10 },
                    { address: 2, name: "ä¿ç•™å­—æ®µ", description: "ç³»ç»Ÿä¿ç•™å­—æ®µ", type: "EEPROM", access: "RO", defaultValue: 0 },
                    { address: 3, name: "èˆµæœºä¸»ç‰ˆæœ¬", description: "èˆµæœºç¡¬ä»¶ä¸»è¦ç‰ˆæœ¬å·", type: "EEPROM", access: "RO", defaultValue: 9 },
                    { address: 4, name: "èˆµæœºå‰¯ç‰ˆæœ¬", description: "èˆµæœºç¡¬ä»¶æ¬¡è¦ç‰ˆæœ¬å·", type: "EEPROM", access: "RO", defaultValue: 3 },

                    // EPROMåŒºåŸŸ - åŸºæœ¬é…ç½® (è¯»å†™)
                    { address: 5, name: "ID", description: "èˆµæœºé€šä¿¡IDæ ‡è¯†", type: "EEPROM", access: "RW", defaultValue: 1 },
                    { address: 6, name: "æ³¢ç‰¹ç‡", description: "ä¸²å£é€šä¿¡æ³¢ç‰¹ç‡è®¾ç½®", type: "EEPROM", access: "RW", defaultValue: 1 },
                    { address: 7, name: "ä¿ç•™å­—èŠ‚", description: "ç³»ç»Ÿä¿ç•™å­—èŠ‚", type: "EEPROM", access: "RW", defaultValue: 0 },

                    // EPROMåŒºåŸŸ - çŠ¶æ€æ§åˆ¶ (è¯»å†™)
                    { address: 8, name: "çŠ¶æ€è¿”å›çº§åˆ«", description: "æ§åˆ¶èˆµæœºå“åº”çŠ¶æ€ä¿¡æ¯çš„è¯¦ç»†ç¨‹åº¦", type: "EEPROM", access: "RW", defaultValue: 1 },
                    { address: 9, name: "æœ€å°ä½ç½®é™åˆ¶L", description: "èˆµæœºå…è®¸çš„æœ€å°è§’åº¦ä½ç½®ä½å­—èŠ‚", type: "EEPROM", access: "RW", defaultValue: 58 },
                    { address: 10, name: "æœ€å°ä½ç½®é™åˆ¶H", description: "èˆµæœºå…è®¸çš„æœ€å°è§’åº¦ä½ç½®é«˜å­—èŠ‚", type: "EEPROM", access: "RW", defaultValue: 3 },
                    { address: 11, name: "æœ€å¤§ä½ç½®é™åˆ¶L", description: "èˆµæœºå…è®¸çš„æœ€å¤§è§’åº¦ä½ç½®ä½å­—èŠ‚", type: "EEPROM", access: "RW", defaultValue: 185 },
                    { address: 12, name: "æœ€å¤§ä½ç½®é™åˆ¶H", description: "èˆµæœºå…è®¸çš„æœ€å¤§è§’åº¦ä½ç½®é«˜å­—èŠ‚", type: "EEPROM", access: "RW", defaultValue: 12 },
                    { address: 13, name: "æœ€é«˜æ¸©åº¦é™åˆ¶", description: "èˆµæœºå·¥ä½œæ¸©åº¦ä¸Šé™(Â°C)", type: "EEPROM", access: "RW", defaultValue: 75 },
                    { address: 14, name: "æœ€é«˜è¾“å…¥ç”µå‹", description: "å…è®¸çš„æœ€é«˜å·¥ä½œç”µå‹(0.1V)", type: "EEPROM", access: "RW", defaultValue: 140 },
                    { address: 15, name: "æœ€ä½è¾“å…¥ç”µå‹", description: "å…è®¸çš„æœ€ä½å·¥ä½œç”µå‹(0.1V)", type: "EEPROM", access: "RW", defaultValue: 60 },
                    { address: 16, name: "æœ€å¤§æ‰­çŸ©é™åˆ¶L", description: "èˆµæœºæœ€å¤§æ‰­çŸ©è¾“å‡ºé™åˆ¶ä½å­—èŠ‚", type: "EEPROM", access: "RW", defaultValue: 232 },
                    { address: 17, name: "æœ€å¤§æ‰­çŸ©é™åˆ¶H", description: "èˆµæœºæœ€å¤§æ‰­çŸ©è¾“å‡ºé™åˆ¶é«˜å­—èŠ‚", type: "EEPROM", access: "RW", defaultValue: 3 },
                    { address: 18, name: "è®¾ç½®å­—èŠ‚", description: "èˆµæœºè¡Œä¸ºå’Œå“åº”çš„ç»¼åˆé…ç½®", type: "EEPROM", access: "RW", defaultValue: 12 },
                    { address: 19, name: "ä¿æŠ¤å¼€å…³", description: "å„ç§ä¿æŠ¤æœºåˆ¶çš„å¼€å…³æ§åˆ¶", type: "EEPROM", access: "RW", defaultValue: 44 },

                    // EPROMåŒºåŸŸ - PIDæ§åˆ¶å‚æ•° (è¯»å†™)
                    { address: 21, name: "ä½ç½®På¢ç›Š", description: "ä½ç½®æ¯”ä¾‹æ§åˆ¶å™¨å¢ç›Š", type: "EEPROM", access: "RW", defaultValue: 32 },
                    { address: 22, name: "ä½ç½®Då¢ç›Š", description: "ä½ç½®å¾®åˆ†æ§åˆ¶å™¨å¢ç›Š", type: "EEPROM", access: "RW", defaultValue: 32 },
                    { address: 23, name: "ä½ç½®Iå¢ç›Š", description: "ä½ç½®ç§¯åˆ†æ§åˆ¶å™¨å¢ç›Š", type: "EEPROM", access: "RW", defaultValue: 0 },

                    // EPROMåŒºåŸŸ - é«˜çº§æ§åˆ¶å‚æ•° (è¯»å†™)
                    { address: 24, name: "å¯åŠ¨æ‰­çŸ©", description: "èˆµæœºå¯åŠ¨æ—¶çš„åˆå§‹æ‰­çŸ©è¾“å‡º", type: "EEPROM", access: "RW", defaultValue: 16 },
                    { address: 25, name: "æœ€å¤§ç”µæµé™åˆ¶", description: "èˆµæœºå·¥ä½œç”µæµä¸Šé™", type: "EEPROM", access: "RW", defaultValue: 0 },
                    { address: 26, name: "é¡ºæ—¶é’ˆæ­»åŒº", description: "é¡ºæ—¶é’ˆæ–¹å‘çš„ä½ç½®æ­»åŒº", type: "EEPROM", access: "RW", defaultValue: 1 },
                    { address: 27, name: "é€†æ—¶é’ˆæ­»åŒº", description: "é€†æ—¶é’ˆæ–¹å‘çš„ä½ç½®æ­»åŒº", type: "EEPROM", access: "RW", defaultValue: 1 },
                    { address: 28, name: "è¿‡è½½ç”µæµL", description: "è§¦å‘è¿‡è½½ä¿æŠ¤çš„ç”µæµé˜ˆå€¼ä½å­—èŠ‚", type: "EEPROM", access: "RW", defaultValue: 244 },
                    { address: 29, name: "è¿‡è½½ç”µæµH", description: "è§¦å‘è¿‡è½½ä¿æŠ¤çš„ç”µæµé˜ˆå€¼é«˜å­—èŠ‚", type: "EEPROM", access: "RW", defaultValue: 1 },
                    { address: 30, name: "è§’åº¦åˆ†è¾¨ç‡", description: "ä½ç½®æ§åˆ¶çš„åˆ†è¾¨ç‡è®¾ç½®", type: "EEPROM", access: "RW", defaultValue: 1 },
                    { address: 31, name: "ä½ç½®åç§»å€¼L", description: "ä½ç½®æ ¡å‡†çš„åç§»é‡ä½å­—èŠ‚", type: "EEPROM", access: "RW", defaultValue: 179 },
                    { address: 32, name: "ä½ç½®åç§»å€¼H", description: "ä½ç½®æ ¡å‡†çš„åç§»é‡é«˜å­—èŠ‚", type: "EEPROM", access: "RW", defaultValue: 0 },
                    { address: 33, name: "å·¥ä½œæ¨¡å¼", description: "èˆµæœºå·¥ä½œæ¨¡å¼é€‰æ‹©", type: "EEPROM", access: "RW", defaultValue: 0 },
                    { address: 34, name: "ä¿æŠ¤æ‰­çŸ©", description: "è§¦å‘æ‰­çŸ©ä¿æŠ¤çš„æ‰­çŸ©å€¼", type: "EEPROM", access: "RW", defaultValue: 20 },
                    { address: 35, name: "è¿‡è½½ä¿æŠ¤æ—¶é—´L", description: "è¿‡è½½çŠ¶æ€æŒç»­å¤šä¹…è§¦å‘ä¿æŠ¤ä½å­—èŠ‚", type: "EEPROM", access: "RW", defaultValue: 200 },
                    { address: 36, name: "è¿‡è½½ä¿æŠ¤æ—¶é—´H", description: "è¿‡è½½çŠ¶æ€æŒç»­å¤šä¹…è§¦å‘ä¿æŠ¤é«˜å­—èŠ‚", type: "EEPROM", access: "RW", defaultValue: 0 },
                    { address: 37, name: "é€Ÿåº¦På¢ç›Š", description: "é€Ÿåº¦æ¯”ä¾‹æ§åˆ¶å™¨å¢ç›Š", type: "EEPROM", access: "RW", defaultValue: 10 },
                    { address: 38, name: "ä¿ç•™2", description: "ä¿ç•™å­—æ®µ", type: "EEPROM", access: "RW", defaultValue: 0 },
                    { address: 39, name: "é€Ÿåº¦Iå¢ç›Š", description: "é€Ÿåº¦ç§¯åˆ†æ§åˆ¶å™¨å¢ç›Š", type: "EEPROM", access: "RW", defaultValue: 200 },

                    // EPROMåŒºåŸŸ - ä¿æŠ¤æœºåˆ¶
                    { address: 20, name: "LEDè­¦æŠ¥æ¡ä»¶", description: "LEDæŒ‡ç¤ºç¯çš„è­¦æŠ¥æ¡ä»¶", type: "EEPROM", access: "RW", defaultValue: 47 },
                    { address: 36, name: "è¿‡è½½æ‰­çŸ©", description: "è¿‡è½½æ£€æµ‹çš„æ‰­çŸ©é˜ˆå€¼", type: "EEPROM", access: "RW", defaultValue: 80 },
                    { address: 38, name: "è¿‡æµä¿æŠ¤æ—¶é—´", description: "è¿‡æµçŠ¶æ€æŒç»­å¤šä¹…è§¦å‘ä¿æŠ¤", type: "EEPROM", access: "RW", defaultValue: 200 },

                    // SRAMåŒºåŸŸ - å®æ—¶æ§åˆ¶ (è¯»å†™)
                    { address: 40, name: "æ‰­çŸ©ä½¿èƒ½", description: "æ˜¯å¦å¯ç”¨æ‰­çŸ©è¾“å‡º", type: "RAM", access: "RW", defaultValue: 0 },
                    { address: 41, name: "ç›®æ ‡åŠ é€Ÿåº¦", description: "èˆµæœºè¿åŠ¨çš„åŠ é€Ÿåº¦è®¾ç½®", type: "RAM", access: "RW", defaultValue: 0 },
                    { address: 42, name: "ç›®æ ‡ä½ç½®L", description: "èˆµæœºè¿åŠ¨çš„ç›®æ ‡ä½ç½®ä½å­—èŠ‚", type: "RAM", access: "RW", defaultValue: 0 },
                    { address: 43, name: "ç›®æ ‡ä½ç½®H", description: "èˆµæœºè¿åŠ¨çš„ç›®æ ‡ä½ç½®é«˜å­—èŠ‚", type: "RAM", access: "RW", defaultValue: 0 },
                    { address: 44, name: "ç›®æ ‡PWML", description: "ç›´æ¥æ§åˆ¶PWMè¾“å‡ºä½å­—èŠ‚", type: "RAM", access: "RW", defaultValue: 0 },
                    { address: 45, name: "ç›®æ ‡PWMH", description: "ç›´æ¥æ§åˆ¶PWMè¾“å‡ºé«˜å­—èŠ‚", type: "RAM", access: "RW", defaultValue: 0 },
                    { address: 46, name: "ç›®æ ‡é€Ÿåº¦L", description: "èˆµæœºè¿åŠ¨çš„ç›®æ ‡é€Ÿåº¦ä½å­—èŠ‚", type: "RAM", access: "RW", defaultValue: 0 },
                    { address: 47, name: "ç›®æ ‡é€Ÿåº¦H", description: "èˆµæœºè¿åŠ¨çš„ç›®æ ‡é€Ÿåº¦é«˜å­—èŠ‚", type: "RAM", access: "RW", defaultValue: 0 },
                    { address: 48, name: "æ‰­çŸ©é™åˆ¶L", description: "è¿è¡Œæ—¶çš„æ‰­çŸ©é™åˆ¶ä½å­—èŠ‚", type: "RAM", access: "RW", defaultValue: 0 },
                    { address: 49, name: "æ‰­çŸ©é™åˆ¶H", description: "è¿è¡Œæ—¶çš„æ‰­çŸ©é™åˆ¶é«˜å­—èŠ‚", type: "RAM", access: "RW", defaultValue: 0 },

                    // SRAMåŒºåŸŸ - çŠ¶æ€åé¦ˆ (åªè¯»)
                    { address: 55, name: "é”å®š", description: "EEPROMå†™ä¿æŠ¤çŠ¶æ€", type: "RAM", access: "RW", defaultValue: 1 },
                    { address: 56, name: "å½“å‰ä½ç½®L", description: "èˆµæœºå®æ—¶ä½ç½®åé¦ˆä½å­—èŠ‚", type: "RAM", access: "RO", defaultValue: 0 },
                    { address: 57, name: "å½“å‰ä½ç½®H", description: "èˆµæœºå®æ—¶ä½ç½®åé¦ˆé«˜å­—èŠ‚", type: "RAM", access: "RO", defaultValue: 0 },
                    { address: 58, name: "å½“å‰é€Ÿåº¦L", description: "èˆµæœºå®æ—¶é€Ÿåº¦åé¦ˆä½å­—èŠ‚", type: "RAM", access: "RO", defaultValue: 0 },
                    { address: 59, name: "å½“å‰é€Ÿåº¦H", description: "èˆµæœºå®æ—¶é€Ÿåº¦åé¦ˆé«˜å­—èŠ‚", type: "RAM", access: "RO", defaultValue: 0 },
                    { address: 60, name: "å½“å‰PWML", description: "èˆµæœºå®æ—¶PWMè¾“å‡ºä½å­—èŠ‚", type: "RAM", access: "RO", defaultValue: 0 },
                    { address: 61, name: "å½“å‰PWMH", description: "èˆµæœºå®æ—¶PWMè¾“å‡ºé«˜å­—èŠ‚", type: "RAM", access: "RO", defaultValue: 0 },
                    { address: 62, name: "å½“å‰è¾“å…¥ç”µå‹", description: "å®æ—¶å·¥ä½œç”µå‹(0.1V)", type: "RAM", access: "RO", defaultValue: 0 },
                    { address: 63, name: "å½“å‰æ¸©åº¦", description: "èˆµæœºå®æ—¶æ¸©åº¦(Â°C)", type: "RAM", access: "RO", defaultValue: 0 },
                    { address: 64, name: "åŒæ­¥å†™å…¥æ ‡å¿—", description: "åŒæ­¥å†™å…¥æ“ä½œçŠ¶æ€", type: "RAM", access: "RO", defaultValue: 0 },
                    { address: 65, name: "ç¡¬ä»¶é”™è¯¯çŠ¶æ€", description: "è¯¦ç»†çš„ç¡¬ä»¶é”™è¯¯ä¿¡æ¯", type: "RAM", access: "RO", defaultValue: 0 },
                    { address: 66, name: "è¿åŠ¨çŠ¶æ€", description: "èˆµæœºè¿åŠ¨çŠ¶æ€æŒ‡ç¤º", type: "RAM", access: "RO", defaultValue: 0 },
                    { address: 67, name: "å½“å‰ç”µæµL", description: "èˆµæœºå®æ—¶å·¥ä½œç”µæµä½å­—èŠ‚", type: "RAM", access: "RO", defaultValue: 0 },
                    { address: 68, name: "å½“å‰ç”µæµH", description: "èˆµæœºå®æ—¶å·¥ä½œç”µæµé«˜å­—èŠ‚", type: "RAM", access: "RO", defaultValue: 0 },

                    // é»˜è®¤å‚æ•°åŒºåŸŸ (ç³»ç»Ÿçº§)
                    { address: 80, name: "è¿åŠ¨é˜ˆå€¼", description: "è¿åŠ¨æ£€æµ‹çš„é˜ˆå€¼è®¾ç½®", type: "RAM", access: "RW", defaultValue: 1 },
                    { address: 81, name: "DTs(ms)", description: "æ—¶é—´é‡‡æ ·é—´éš”(ms)", type: "RAM", access: "RW", defaultValue: 20 },
                    { address: 82, name: "Vk(ms)", description: "é€Ÿåº¦é‡‡æ ·æ—¶é—´(ms)", type: "RAM", access: "RW", defaultValue: 50 },
                    { address: 83, name: "Vmin", description: "æœ€å°é€Ÿåº¦é™åˆ¶", type: "RAM", access: "RW", defaultValue: 1 },
                    { address: 84, name: "Vmax", description: "æœ€å¤§é€Ÿåº¦é™åˆ¶", type: "RAM", access: "RW", defaultValue: 68 },
                    { address: 85, name: "Amax", description: "æœ€å¤§åŠ é€Ÿåº¦é™åˆ¶", type: "RAM", access: "RW", defaultValue: 254 },
                    { address: 86, name: "KAcc", description: "åŠ é€Ÿåº¦ç³»æ•°", type: "RAM", access: "RW", defaultValue: 0 }
                ];

                this.memoryMap = memoryMap;
                this.renderMemoryTable();
            }

            renderMemoryTable() {
                const tableBody = document.getElementById('memoryTableBody');
                if (!tableBody) return;

                tableBody.innerHTML = '';

                this.memoryMap.forEach((item, index) => {
                    const row = document.createElement('div');
                    row.className = `memory-row ${item.type.toLowerCase()}`;
                    row.dataset.address = item.address;
                    row.dataset.type = item.type;
                    row.dataset.name = item.name.toLowerCase();
                    row.dataset.description = item.description.toLowerCase();

                    row.innerHTML = `
                        <div class="memory-address">${item.address.toString(16).toUpperCase()}</div>
                        <div class="memory-name">${item.name}</div>
                        <div class="memory-description">${item.description}</div>
                        <div class="memory-type ${item.type.toLowerCase()}">${item.type}</div>
                        <div class="memory-access ${item.access.toLowerCase()}">${item.access}</div>
                        <div class="memory-value" id="value-${item.address}">-</div>
                        <div class="memory-actions">
                            <button class="mini-button read" onclick="readMemoryAddress(${item.address})">è¯»</button>
                            ${item.access === 'RW' ? `<button class="mini-button write" onclick="writeMemoryAddress(${item.address})">å†™</button>` : ''}
                        </div>
                    `;

                    tableBody.appendChild(row);
                });
            }

            handleConnection(message) {
                this.addLog(`[ç³»ç»Ÿ] æœåŠ¡å™¨çŠ¶æ€: ${message.status}`,
                           message.status === 'connected' ? 'success' : 'info');
            }

            handleScanResult(message) {
                this.addLog(`[æ‰«æ] å®Œæˆ: å‘ç° ${message.count} ä¸ªè®¾å¤‡`, 'success');
                this.displayServoList(message.servos);

                // éšè—æ‰«æçŠ¶æ€
                const scanStatus = document.getElementById('scanStatus');
                if (scanStatus) {
                    scanStatus.style.display = 'none';
                }

                // å¡«å……æ ‡å®šé€‰æ‹©å™¨
                this.populateCalibrationSelectors(message.servos);
            }

            displayServoList(servos) {
                const listContainer = document.getElementById('servoList');
                if (!listContainer) return;

                listContainer.innerHTML = '';

                if (servos.length === 0) {
                    listContainer.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-icon">ğŸ¤–</div>
                            <div class="empty-title">æœªå‘ç°è®¾å¤‡</div>
                            <div class="empty-description">è¯·æ£€æŸ¥è®¾å¤‡è¿æ¥å’Œä¾›ç”µ</div>
                        </div>
                    `;
                    return;
                }

                servos.forEach(servo => {
                    const servoElement = document.createElement('div');
                    servoElement.className = 'servo-item';
                    servoElement.onclick = () => this.selectServo(servo.id);

                    servoElement.innerHTML = `
                        <div class="servo-id">èˆµæœº #${servo.id}</div>
                        <div class="servo-info">
                            <span>å‹å·: ${servo.model_number || 'FTServo'}</span>
                            <div class="servo-status">
                                <div class="status-dot"></div>
                                <span>åœ¨çº¿</span>
                            </div>
                        </div>
                        <div class="servo-details">
                            <div class="servo-detail-item">
                                <span>ğŸ”—</span>
                                <span>ID: ${servo.id}</span>
                            </div>
                            <div class="servo-detail-item">
                                <span>ğŸ“‹</span>
                                <span>${servo.vendor || 'FEETECH'}</span>
                            </div>
                        </div>
                    `;

                    listContainer.appendChild(servoElement);
                });
            }

            selectServo(servoId) {
                this.selectedServoId = servoId;

                // æ›´æ–°UIé€‰ä¸­çŠ¶æ€
                document.querySelectorAll('.servo-item').forEach(item => {
                    item.classList.remove('selected');
                });
                event.currentTarget.classList.add('selected');

                // æ˜¾ç¤ºæ§åˆ¶é¢æ¿
                this.showControlPanel();

                // è·å–èˆµæœºçŠ¶æ€
                this.getServoStatus(servoId);

                // æ›´æ–°æ ‡å®šç•Œé¢ä¸­çš„èˆµæœºæ˜¾ç¤º
                if (typeof updateCalibrationServoDisplay === 'function') {
                    updateCalibrationServoDisplay();
                }

                this.addLog(`[æ§åˆ¶] å·²é€‰æ‹©èˆµæœº ${servoId}`, 'success');
            }

            showControlPanel() {
                const controlPanel = document.getElementById('controlPanel');
                if (!controlPanel) return;

                controlPanel.innerHTML = `
                    <div class="control-group">
                        <label>æ§åˆ¶æ¨¡å¼</label>
                        <div class="control-group">
                            <button class="button ${this.controlMode === 'manual' ? '' : 'warning'}" onclick="setControlMode('manual')" style="margin-bottom: 8px;">
                                ${this.controlMode === 'manual' ? 'âœ…' : ''} ğŸ¯ æ‰‹åŠ¨æ¨¡å¼
                            </button>
                            <button class="button ${this.controlMode === 'realtime' ? '' : 'success'}" onclick="setControlMode('realtime')">
                                ${this.controlMode === 'realtime' ? 'âœ…' : ''} âš¡ å®æ—¶æ¨¡å¼
                            </button>
                        </div>
                    </div>

                    <div class="control-group">
                        <label>ä½ç½®æ§åˆ¶ (0-4095)</label>
                        <div class="slider-container">
                            <input type="range" id="positionSlider" class="slider" min="0" max="4095" value="2048" oninput="updatePositionFromSlider(this.value)">
                            <span class="slider-value" id="positionValue">2048</span>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 100px; gap: 8px;">
                            <input type="number" id="positionInput" min="0" max="4095" value="2048" onchange="updatePositionFromInput(this.value)">
                            <button class="button" onclick="moveServo()">ç§»åŠ¨</button>
                        </div>
                    </div>

                    <div class="control-group">
                        <label>é€Ÿåº¦æ§åˆ¶ (0-2047)</label>
                        <div class="slider-container">
                            <input type="range" id="speedSlider" class="slider" min="0" max="2047" value="100" oninput="updateSpeedFromSlider(this.value)">
                            <span class="slider-value" id="speedValue">100</span>
                        </div>
                    </div>

                    <div class="control-group">
                        <label>åŠ é€Ÿåº¦æ§åˆ¶ (0-255)</label>
                        <div class="slider-container">
                            <input type="range" id="accelSlider" class="slider" min="0" max="255" value="50" oninput="updateAccelFromSlider(this.value)">
                            <span class="slider-value" id="accelValue">50</span>
                        </div>
                    </div>

                    <div class="control-group">
                        <label>å¿«é€Ÿé¢„è®¾</label>
                        <div class="preset-grid">
                            <button class="preset-button" onclick="setPosition(0)">0Â°</button>
                            <button class="preset-button" onclick="setPosition(512)">45Â°</button>
                            <button class="preset-button" onclick="setPosition(1024)">90Â°</button>
                            <button class="preset-button" onclick="setPosition(1536)">135Â°</button>
                            <button class="preset-button" onclick="setPosition(2048)">180Â°</button>
                            <button class="preset-button" onclick="setPosition(2560)">225Â°</button>
                            <button class="preset-button" onclick="setPosition(3072)">270Â°</button>
                            <button class="preset-button" onclick="setPosition(3584)">315Â°</button>
                        </div>
                    </div>

                    <div class="quick-actions">
                        <button class="button" onclick="refreshStatus()">
                            <span>ğŸ”„</span> åˆ·æ–°çŠ¶æ€
                        </button>
                        <button class="button danger" onclick="stopServo()">
                            <span>â¹ï¸</span> åœæ­¢èˆµæœº
                        </button>
                    </div>
                `;

                // åˆå§‹åŒ–å®æ—¶æ§åˆ¶
                this.initRealtimeControl();
            }

            updateServoStatus(status) {
                if (!status || status.id !== this.selectedServoId) return;

                const statusPanel = document.getElementById('statusPanel');
                if (!statusPanel) return;

                statusPanel.innerHTML = `
                    <div class="status-grid">
                        <div class="status-item">
                            <span class="status-label">è¿æ¥çŠ¶æ€:</span>
                            <span class="status-value">${status.connected ? 'âœ… å·²è¿æ¥' : 'âŒ æ–­å¼€'}</span>
                        </div>
                        <div class="status-item">
                            <span class="status-label">å½“å‰ID:</span>
                            <span class="status-value">#${status.id}</span>
                        </div>
                        <div class="status-item">
                            <span class="status-label">ä½ç½®:</span>
                            <span class="status-value">${status.position || 'N/A'}</span>
                        </div>
                        <div class="status-item">
                            <span class="status-label">é€Ÿåº¦:</span>
                            <span class="status-value">${status.speed || 'N/A'}</span>
                        </div>
                        <div class="status-item">
                            <span class="status-label">æ¸©åº¦:</span>
                            <span class="status-value">${status.temperature ? status.temperature + 'Â°C' : 'N/A'}</span>
                        </div>
                        <div class="status-item">
                            <span class="status-label">ç”µå‹:</span>
                            <span class="status-value">${status.voltage ? status.voltage.toFixed(1) + 'V' : 'N/A'}</span>
                        </div>
                        <div class="status-item">
                            <span class="status-label">ç”µæµ:</span>
                            <span class="status-value">${status.current ? status.current + 'mA' : 'N/A'}</span>
                        </div>
                        <div class="status-item">
                            <span class="status-label">æ›´æ–°æ—¶é—´:</span>
                            <span class="status-value">${new Date(status.timestamp * 1000).toLocaleTimeString()}</span>
                        </div>
                    </div>
                `;
            }

            handleServoStatus(message) {
                this.updateServoStatus(message.status);
            }

            handleMoveResult(message) {
                if (message.success) {
                    this.addLog(`[æ§åˆ¶] è®¾å¤‡ ${message.servo_id} ç§»åŠ¨æˆåŠŸ`, 'success');
                } else {
                    this.addLog(`[æ§åˆ¶] è®¾å¤‡ ${message.servo_id} ç§»åŠ¨å¤±è´¥: ${message.error}`, 'error');
                }
            }

            handleMemoryRead(message) {
                const valueElement = document.getElementById(`value-${message.address}`);
                if (valueElement && message.data) {
                    // å°†å­—èŠ‚æ•°ç»„è½¬æ¢ä¸ºæ•°å€¼
                    let decimalValue = 0;
                    let displayValue = '';

                    if (Array.isArray(message.data) && message.data.length > 0) {
                        // å¤šå­—èŠ‚æ•°æ®ï¼šè½¬æ¢ä¸º16ä½æ•°å€¼
                        if (message.data.length === 2) {
                            // å°ç«¯åºï¼šä½å­—èŠ‚åœ¨å‰
                            decimalValue = message.data[0] | (message.data[1] << 8);
                            displayValue = decimalValue.toString();
                        } else {
                            // å•å­—èŠ‚æ•°æ®
                            decimalValue = message.data[0];
                            displayValue = decimalValue.toString();
                        }
                    } else if (typeof message.data === 'string') {
                        // å¦‚æœæœåŠ¡å™¨ç›´æ¥è¿”å›äº†åå…­è¿›åˆ¶å­—ç¬¦ä¸²
                        decimalValue = parseInt(message.data, 16);
                        displayValue = decimalValue.toString();
                    } else {
                        displayValue = 'N/A';
                    }

                    // æ ¹æ®åœ°å€ç±»å‹è¿›è¡Œç‰¹æ®Šå¤„ç†
                    const memoryItem = this.memoryMap.find(item => item.address === message.address);
                    if (memoryItem) {
                        // ç”µå‹å€¼ç‰¹æ®Šå¤„ç†ï¼š0.1Vä¸ºå•ä½
                        if (memoryItem.name.includes('ç”µå‹') && decimalValue > 0) {
                            displayValue = (decimalValue * 0.1).toFixed(1) + 'V';
                        }
                        // æ¸©åº¦å€¼ç‰¹æ®Šå¤„ç†
                        else if (memoryItem.name.includes('æ¸©åº¦')) {
                            displayValue = decimalValue + 'Â°C';
                        }
                        // æ—¶é—´å€¼ç‰¹æ®Šå¤„ç†
                        else if (memoryItem.name.includes('ms') || memoryItem.name.includes('æ—¶é—´')) {
                            displayValue = decimalValue + 'ms';
                        }
                        // ä½ç½®å€¼ç‰¹æ®Šå¤„ç†ï¼ˆé€šå¸¸éœ€è¦ç‰¹æ®Šå•ä½è½¬æ¢ï¼‰
                        else if (memoryItem.name.includes('ä½ç½®') && decimalValue > 0) {
                            displayValue = decimalValue + ' (0-4095)';
                        }
                    }

                    valueElement.textContent = displayValue;
                    this.memoryData.set(message.address, {
                        raw: message.data,
                        decimal: decimalValue,
                        display: displayValue
                    });

                    this.addLog(`[å†…å­˜] åœ°å€ ${message.address.toString(16).toUpperCase()}: è¯»å–å€¼ = ${displayValue} (åè¿›åˆ¶: ${decimalValue})`, 'success');
                } else {
                    this.addLog(`[å†…å­˜] åœ°å€ ${message.address.toString(16).toUpperCase()}: è¯»å–å¤±è´¥`, 'error');
                }
            }

            handleTemperatureLimit(message) {
                if (message.success) {
                    this.addLog(`[æ¸©åº¦] æ¸©åº¦é™åˆ¶: ${message.limit}Â°C`, 'success');

                    // æ›´æ–°å†…å­˜è¡¨æ ¼ä¸­çš„å€¼
                    const valueElement = document.getElementById('value-13');
                    if (valueElement) {
                        valueElement.textContent = message.limit;
                        this.memoryData.set(13, message.limit);
                    }
                } else {
                    this.addLog(`[æ¸©åº¦] è¯»å–æ¸©åº¦é™åˆ¶å¤±è´¥: ${message.error}`, 'error');
                }
            }

            handleServoIdSetResult(message) {
                if (message.success) {
                    this.addLog(`[IDé…ç½®] èˆµæœºIDè®¾ç½®æˆåŠŸ: ${message.old_id} -> ${message.new_id}`, 'success');
                    // è‡ªåŠ¨é‡æ–°æ‰«æä»¥æ›´æ–°è®¾å¤‡åˆ—è¡¨
                    setTimeout(() => {
                        this.sendMessage({
                            type: 'scan_servos',
                            start_id: 1,
                            end_id: 20
                        });
                    }, 1000);
                } else {
                    this.addLog(`[IDé…ç½®] èˆµæœºIDè®¾ç½®å¤±è´¥: ${message.error}`, 'error');
                }
            }

            updateConnectionStatus(connected) {
                const indicator = document.getElementById('statusIndicator');
                const status = document.getElementById('connectionStatus');

                if (connected) {
                    indicator.classList.add('connected');
                    status.textContent = 'å·²è¿æ¥åˆ°æœåŠ¡å™¨';
                } else {
                    indicator.classList.remove('connected');
                    status.textContent = 'è¿æ¥æ–­å¼€';
                }
            }

            populateCalibrationSelectors(servos) {
                const selectors = [
                    'calibrationServoSelect',
                    'tempCalibrationServoSelect',
                    'centerCalibrationServoSelect'
                ];

                selectors.forEach(selectorId => {
                    const select = document.getElementById(selectorId);
                    if (select) {
                        const currentValue = select.value;
                        select.innerHTML = '<option value="">é€‰æ‹©èˆµæœº...</option>';

                        servos.forEach(servo => {
                            const option = document.createElement('option');
                            option.value = servo.id;
                            option.textContent = `èˆµæœº #${servo.id} - ${servo.model_number || 'FTServo'}`;
                            if (currentValue == servo.id) {
                                option.selected = true;
                            }
                            select.appendChild(option);
                        });
                    }
                });
            }

            // å®æ—¶æ§åˆ¶æ–¹æ³•
            initRealtimeControl() {
                this.realtimeEnabled = false;
            }

            setControlMode(mode) {
                this.controlMode = mode;
                this.realtimeEnabled = (mode === 'realtime');

                if (this.realtimeEnabled) {
                    this.addLog('[æ§åˆ¶] å®æ—¶æ¨¡å¼å·²å¯ç”¨ - æ‹–åŠ¨æ»‘å—å³å¯æ§åˆ¶', 'success');
                } else {
                    this.addLog('[æ§åˆ¶] æ‰‹åŠ¨æ¨¡å¼å·²å¯ç”¨ - ç‚¹å‡»æŒ‰é’®æ‰§è¡Œç§»åŠ¨', 'info');
                }
            }

            moveServoRealtime(position, speed, acceleration) {
                const now = Date.now();
                if (now - this.lastMoveTime < this.moveDebounceDelay) {
                    return;
                }
                this.lastMoveTime = now;

                if (!this.selectedServoId) {
                    return;
                }

                this.sendMessage({
                    type: 'move_servo',
                    servo_id: this.selectedServoId,
                    position: parseInt(position),
                    speed: parseInt(speed),
                    acceleration: parseInt(acceleration)
                });
            }

            sendMessage(message) {
                if (this.ws && this.ws.readyState === WebSocket.OPEN) {
                    this.ws.send(JSON.stringify(message));
                    return true;
                }
                this.addLog('[WebSocket] æ— æ³•å‘é€æ¶ˆæ¯: è¿æ¥æ–­å¼€', 'error');
                return false;
            }

            addLog(message, type = 'info') {
                const logContent = document.getElementById('logContent');
                if (!logContent) return;

                const timestamp = new Date().toLocaleTimeString();
                const logEntry = document.createElement('div');
                logEntry.className = `log-entry ${type}`;
                logEntry.textContent = `[${timestamp}] ${message}`;

                logContent.appendChild(logEntry);
                logContent.scrollTop = logContent.scrollHeight;

                // é™åˆ¶æ—¥å¿—æ¡æ•°
                const entries = logContent.children;
                if (entries.length > 100) {
                    logContent.removeChild(entries[0]);
                }
            }
        }

        // å…¨å±€æ§åˆ¶å™¨å®ä¾‹
        let controller;

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            controller = new SeeedRoboCoreController();
        });

        // Tabåˆ‡æ¢åŠŸèƒ½
        function switchTab(tabName) {
            // æ›´æ–°tabæŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            // æ›´æ–°tabå†…å®¹æ˜¾ç¤º
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${tabName}-tab`).classList.add('active');
        }

        // å…¨å±€åŠŸèƒ½å‡½æ•°
        function scanServos() {
            // æ˜¾ç¤ºæ‰«æçŠ¶æ€
            const scanStatus = document.getElementById('scanStatus');
            if (scanStatus) {
                scanStatus.style.display = 'flex';
            }

            controller.sendMessage({
                type: 'scan_servos',
                start_id: 1,
                end_id: 20
            });

            controller.addLog('[æ‰«æ] å¼€å§‹é‡æ–°æ‰«æè®¾å¤‡...', 'info');
        }

        // å®æ—¶æ§åˆ¶å‡½æ•°
        function setControlMode(mode) {
            controller.setControlMode(mode);
        }

        function updatePositionFromSlider(value) {
            document.getElementById('positionValue').textContent = value;
            document.getElementById('positionInput').value = value;

            if (controller.realtimeEnabled && controller.selectedServoId) {
                const speed = document.getElementById('speedSlider').value;
                const acceleration = document.getElementById('accelSlider').value;
                controller.moveServoRealtime(value, speed, acceleration);
            }
        }

        function updatePositionFromInput(value) {
            document.getElementById('positionSlider').value = value;
            document.getElementById('positionValue').textContent = value;
        }

        function updateSpeedFromSlider(value) {
            document.getElementById('speedValue').textContent = value;
            document.getElementById('speedInput').value = value;
        }

        function updateSpeedFromInput(value) {
            document.getElementById('speedSlider').value = value;
            document.getElementById('speedValue').textContent = value;
        }

        function updateAccelFromSlider(value) {
            document.getElementById('accelValue').textContent = value;
            document.getElementById('accelInput').value = value;
        }

        function updateAccelFromInput(value) {
            document.getElementById('accelSlider').value = value;
            document.getElementById('accelValue').textContent = value;
        }

        function setPosition(value) {
            document.getElementById('positionSlider').value = value;
            document.getElementById('positionInput').value = value;
            document.getElementById('positionValue').textContent = value;

            if (controller.realtimeEnabled && controller.selectedServoId) {
                const speed = document.getElementById('speedSlider').value;
                const acceleration = document.getElementById('accelSlider').value;
                controller.moveServoRealtime(value, speed, acceleration);
            }
        }

        function moveServo() {
            if (!controller.selectedServoId) {
                alert('è¯·å…ˆé€‰æ‹©èˆµæœº');
                return;
            }

            const position = parseInt(document.getElementById('positionInput').value);
            const speed = parseInt(document.getElementById('speedInput').value);
            const acceleration = parseInt(document.getElementById('accelInput').value);

            controller.sendMessage({
                type: 'move_servo',
                servo_id: controller.selectedServoId,
                position: position,
                speed: speed,
                acceleration: acceleration
            });
        }

        function stopServo() {
            if (!controller.selectedServoId) {
                alert('è¯·å…ˆé€‰æ‹©èˆµæœº');
                return;
            }

            controller.sendMessage({
                type: 'stop_servo',
                servo_id: controller.selectedServoId
            });
        }

        function refreshStatus() {
            if (!controller.selectedServoId) {
                alert('è¯·å…ˆé€‰æ‹©èˆµæœº');
                return;
            }
            controller.sendMessage({
                type: 'get_servo_status',
                servo_id: controller.selectedServoId
            });
        }

        function clearLog() {
            const logContent = document.getElementById('logContent');
            if (logContent) {
                logContent.innerHTML = '<div class="log-entry info">[ç³»ç»Ÿ] æ—¥å¿—å·²æ¸…ç©º</div>';
            }
        }

        // æ ‡å®šåŠŸèƒ½
        function startCalibration() {
            switchTab('calibration');
        }

        function selectCalibrationType(type) {
            // ç§»é™¤æ‰€æœ‰é€‰ä¸­çŠ¶æ€
            document.querySelectorAll('.calibration-card').forEach(card => {
                card.classList.remove('active');
            });

            // æ¿€æ´»é€‰ä¸­çš„ç±»å‹
            const selectedCard = document.getElementById(`cal-${type}`);
            if (selectedCard) {
                selectedCard.classList.add('active');
            }

            // æ˜¾ç¤ºå¯¹åº”çš„æ ‡å®šå†…å®¹
            showCalibrationContent(type);
        }

        function showCalibrationContent(type) {
            const contentArea = document.getElementById('calibrationContent');
            let contentHTML = '';

            switch(type) {
                case 'id':
                    contentHTML = `
                        <div class="control-group">
                            <label>å½“å‰é…ç½®èˆµæœº: <span id="currentIdCalibrationServo" style="color: var(--seeed-green); font-weight: bold;">æœªé€‰æ‹©</span></label>
                            <div style="font-size: 0.75rem; color: #718096; margin-top: 4px;">
                                è¯·å…ˆä»å·¦ä¾§è®¾å¤‡ç®¡ç†ä¸­é€‰æ‹©è¦é…ç½®çš„èˆµæœº
                            </div>
                        </div>

                        <div class="control-group">
                            <label>æ–°èˆµæœºID (1-253)</label>
                            <input type="number" id="newServoId" min="1" max="253" value="1">
                        </div>

                        <div class="quick-actions">
                            <button class="button" onclick="scanServos()">
                                <span>ğŸ”</span> é‡æ–°æ‰«æè®¾å¤‡
                            </button>
                            <button class="button success" onclick="setServoId()">
                                <span>ğŸ’¾</span> è®¾ç½®ID
                            </button>
                        </div>
                    `;
                    break;

                case 'temperature':
                    contentHTML = `
                        <div class="control-group">
                            <label>å½“å‰é…ç½®èˆµæœº: <span id="currentTempCalibrationServo" style="color: var(--seeed-green); font-weight: bold;">æœªé€‰æ‹©</span></label>
                            <div style="font-size: 0.75rem; color: #718096; margin-top: 4px;">
                                è¯·å…ˆä»å·¦ä¾§è®¾å¤‡ç®¡ç†ä¸­é€‰æ‹©è¦é…ç½®çš„èˆµæœº
                            </div>
                        </div>

                        <div class="control-group">
                            <label>æ¸©åº¦é™åˆ¶ (Â°C)</label>
                            <div class="slider-container">
                                <input type="range" id="tempLimitSlider" class="slider" min="50" max="100" value="75" oninput="updateTempLimitDisplay(this.value)">
                                <span class="slider-value" id="tempLimitDisplay">75Â°C</span>
                            </div>
                        </div>

                        <div class="quick-actions">
                            <button class="button" onclick="scanServos()">
                                <span>ğŸ”</span> é‡æ–°æ‰«æè®¾å¤‡
                            </button>
                            <button class="button" onclick="readTemperatureLimit()">
                                <span>ğŸ“–</span> è¯»å–å½“å‰å€¼
                            </button>
                            <button class="button success" onclick="setTemperatureLimit()">
                                <span>ğŸ’¾</span> ä¿å­˜æ¸©åº¦é™åˆ¶
                            </button>
                        </div>
                    `;
                    break;

                case 'center':
                    contentHTML = `
                        <div class="manual-mode">
                            <div class="manual-mode-header">
                                <span>âš ï¸</span>
                                <span>æ‰‹åŠ¨æ ¡å‡†æ¨¡å¼</span>
                            </div>
                            <p style="font-size: 0.8rem; color: #92400E; margin-bottom: 10px;">
                                åœ¨æ­¤æ¨¡å¼ä¸‹ï¼Œèˆµæœºæ‰­çŸ©å°†è¢«ç¦ç”¨ï¼Œæ‚¨å¯ä»¥æ‰‹åŠ¨è½¬åŠ¨èˆµæœºåˆ°æ­£ç¡®ä½ç½®ã€‚
                            </p>
                            <button class="torque-button" id="torqueDisableBtn" onclick="toggleTorqueDisable()">
                                <span id="torqueBtnText">ğŸ”“ ç¦ç”¨èˆµæœºæ‰­çŸ©</span>
                            </button>
                        </div>

                        <div class="control-group">
                            <label>å½“å‰æ ¡å‡†èˆµæœº: <span id="currentCalibrationServo" style="color: var(--seeed-green); font-weight: bold;">æœªé€‰æ‹©</span></label>
                            <div style="font-size: 0.75rem; color: #718096; margin-top: 4px;">
                                è¯·å…ˆä»å·¦ä¾§è®¾å¤‡ç®¡ç†ä¸­é€‰æ‹©è¦æ ¡å‡†çš„èˆµæœº
                            </div>
                        </div>

                        <div class="control-group">
                            <label>æ ¡å‡†æŒ‡å¼•:</label>
                            <div style="background: #FEF3C7; border: 1px solid #FCD34D; border-radius: 6px; padding: 10px; font-size: 0.8rem; color: #92400E;">
                                1. ä»å·¦ä¾§è®¾å¤‡ç®¡ç†é€‰æ‹©èˆµæœº<br>
                                2. ç‚¹å‡»"ç¦ç”¨èˆµæœºæ‰­çŸ©"æŒ‰é’®<br>
                                3. æ‰‹åŠ¨è½¬åŠ¨èˆµæœºä½¿èˆµç›˜å®Œå…¨æœä¸Š<br>
                                4. ç‚¹å‡»"ä¿å­˜ä¸­ä½ä½ç½®"
                            </div>
                        </div>

                        <div class="quick-actions">
                            <button class="button" onclick="scanServos()">
                                <span>ğŸ”</span> é‡æ–°æ‰«æè®¾å¤‡
                            </button>
                            <button class="button" onclick="saveCenterPositionManual()">
                                <span>ğŸ’¾</span> ä¿å­˜ä¸­ä½ä½ç½®
                            </button>
                            <button class="button" onclick="testCenterPosition()">
                                <span>ğŸ¯</span> æµ‹è¯•ä¸­ä½
                            </button>
                        </div>
                    `;
                    break;
            }

            contentArea.innerHTML = contentHTML;

            // æ›´æ–°å½“å‰é€‰æ‹©çš„èˆµæœºä¿¡æ¯
            updateCalibrationServoDisplay();
        }

        // æ›´æ–°æ ‡å®šç•Œé¢ä¸­æ˜¾ç¤ºçš„å½“å‰èˆµæœº
        function updateCalibrationServoDisplay() {
            const servoDisplays = [
                'currentCalibrationServo',  // ä¸­ä½æ ¡å‡†
                'currentIdCalibrationServo', // IDé…ç½®
                'currentTempCalibrationServo' // æ¸©åº¦é™åˆ¶
            ];

            servoDisplays.forEach(displayId => {
                const servoDisplay = document.getElementById(displayId);
                if (servoDisplay) {
                    if (controller.selectedServoId) {
                        servoDisplay.textContent = `èˆµæœº #${controller.selectedServoId}`;
                        servoDisplay.style.color = 'var(--seeed-green)';
                        servoDisplay.style.fontWeight = 'bold';
                    } else {
                        servoDisplay.textContent = 'æœªé€‰æ‹©';
                        servoDisplay.style.color = '#718096';
                        servoDisplay.style.fontWeight = 'normal';
                    }
                }
            });
        }

        // æ‰­çŸ©æ§åˆ¶ - ç›´æ¥æ“ä½œå†…å­˜åœ°å€40
        function toggleTorqueDisable() {
            const btn = document.getElementById('torqueDisableBtn');
            const btnText = document.getElementById('torqueBtnText');

            // ä¼˜å…ˆä½¿ç”¨å·²é€‰æ‹©çš„èˆµæœºID
            if (controller.selectedServoId) {
                // ä½¿ç”¨è®¾å¤‡ç®¡ç†ä¸­å·²é€‰æ‹©çš„èˆµæœº
            } else {
                const select = document.getElementById('centerCalibrationServoSelect');
                if (select && select.value) {
                    controller.selectedServoId = parseInt(select.value);
                } else {
                    alert('è¯·å…ˆä»è®¾å¤‡ç®¡ç†ä¸­é€‰æ‹©èˆµæœº');
                    return;
                }
            }

            const isDisabled = btn.classList.contains('active');

            if (isDisabled) {
                // å¯ç”¨æ‰­çŸ© - å†™å…¥1åˆ°åœ°å€40
                controller.sendMessage({
                    type: 'write_memory',
                    servo_id: controller.selectedServoId,
                    address: 40,
                    data: [1]  // å¯ç”¨æ‰­çŸ©
                });

                btn.classList.remove('active');
                btnText.textContent = 'ğŸ”“ ç¦ç”¨èˆµæœºæ‰­çŸ©';

                controller.addLog(`[ä¸­ä½æ ¡å‡†] å·²å¯ç”¨èˆµæœº #${controller.selectedServoId} æ‰­çŸ©`, 'info');
            } else {
                // ç¦ç”¨æ‰­çŸ© - å†™å…¥0åˆ°åœ°å€40
                controller.sendMessage({
                    type: 'write_memory',
                    servo_id: controller.selectedServoId,
                    address: 40,
                    data: [0]  // ç¦ç”¨æ‰­çŸ©
                });

                btn.classList.add('active');
                btnText.textContent = 'ğŸ”’ å¯ç”¨èˆµæœºæ‰­çŸ©';

                controller.addLog(`[ä¸­ä½æ ¡å‡†] å·²ç¦ç”¨èˆµæœº #${controller.selectedServoId} æ‰­çŸ©ï¼Œå¯ä»¥æ‰‹åŠ¨è°ƒæ•´ä½ç½®`, 'warning');
            }
        }

        function saveCenterPositionManual() {
            if (!controller.selectedServoId) {
                alert('è¯·å…ˆé€‰æ‹©è¦æ ¡å‡†çš„èˆµæœº');
                return;
            }

            // è·å–å½“å‰ä½ç½®å¹¶ä¿å­˜
            controller.sendMessage({
                type: 'get_servo_status',
                servo_id: controller.selectedServoId
            });

            controller.calibrationData.centerPosition = parseInt(document.getElementById('positionInput')?.value || 2048);

            controller.addLog(`[ä¸­ä½æ ¡å‡†] ä¿å­˜ä¸­ä½ä½ç½®: ${controller.calibrationData.centerPosition}`, 'success');

            // é‡æ–°å¯ç”¨æ‰­çŸ©
            const btn = document.getElementById('torqueDisableBtn');
            if (btn.classList.contains('active')) {
                toggleTorqueDisable();
            }
        }

        function testCenterPosition() {
            if (!controller.selectedServoId) {
                alert('è¯·å…ˆé€‰æ‹©è¦æµ‹è¯•çš„èˆµæœº');
                return;
            }

            const position = controller.calibrationData.centerPosition || 2048;

            controller.sendMessage({
                type: 'move_servo',
                servo_id: controller.selectedServoId,
                position: position,
                speed: 100,
                acceleration: 50
            });

            controller.addLog(`[ä¸­ä½æ ¡å‡†] æµ‹è¯•ç§»åŠ¨åˆ°ä¸­ä½: ${position}`, 'info');
        }

        function setServoId() {
            if (!controller.selectedServoId) {
                alert('è¯·å…ˆä»è®¾å¤‡ç®¡ç†ä¸­é€‰æ‹©è¦é…ç½®çš„èˆµæœº');
                return;
            }

            const newId = document.getElementById('newServoId').value;
            if (!newId) {
                alert('è¯·è¾“å…¥æ–°ID');
                return;
            }

            const oldId = controller.selectedServoId;
            const newIdNum = parseInt(newId);

            if (newIdNum < 1 || newIdNum > 253) {
                alert('æ–°IDå¿…é¡»åœ¨1-253èŒƒå›´å†…');
                return;
            }

            controller.sendMessage({
                type: 'set_servo_id',
                old_id: oldId,
                new_id: newIdNum
            });

            controller.addLog(`[IDé…ç½®] è®¾ç½®èˆµæœºID: ${oldId} -> ${newIdNum}`, 'info');
        }

        function setTemperatureLimit() {
            if (!controller.selectedServoId) {
                alert('è¯·å…ˆä»è®¾å¤‡ç®¡ç†ä¸­é€‰æ‹©è¦é…ç½®çš„èˆµæœº');
                return;
            }

            const tempLimit = parseInt(document.getElementById('tempLimitSlider').value);

            // ç›´æ¥å†™å…¥å†…å­˜åœ°å€13 (æ¸©åº¦é™åˆ¶)
            controller.sendMessage({
                type: 'write_memory',
                servo_id: controller.selectedServoId,
                address: 13,
                data: [tempLimit]
            });

            controller.addLog(`[æ¸©åº¦é™åˆ¶] è®¾ç½®æ¸©åº¦é™åˆ¶: ${tempLimit}Â°C`, 'info');
        }

        function readTemperatureLimit() {
            if (!controller.selectedServoId) {
                alert('è¯·å…ˆä»è®¾å¤‡ç®¡ç†ä¸­é€‰æ‹©è¦é…ç½®çš„èˆµæœº');
                return;
            }

            // ç›´æ¥è¯»å–å†…å­˜åœ°å€13 (æ¸©åº¦é™åˆ¶)
            controller.sendMessage({
                type: 'read_memory',
                servo_id: controller.selectedServoId,
                address: 13,
                length: 1
            });

            controller.addLog(`[æ¸©åº¦é™åˆ¶] è¯»å–æ¸©åº¦é™åˆ¶`, 'info');
        }

        function updateTempLimitDisplay(value) {
            document.getElementById('tempLimitDisplay').textContent = `${value}Â°C`;
        }

        // å†…å­˜è¡¨æ ¼åŠŸèƒ½
        function filterMemoryTable(searchText) {
            const rows = document.querySelectorAll('.memory-row');
            const lowerSearch = searchText.toLowerCase();

            rows.forEach(row => {
                const name = row.dataset.name || '';
                const description = row.dataset.description || '';
                const address = row.dataset.address || '';

                if (name.includes(lowerSearch) ||
                    description.includes(lowerSearch) ||
                    address.includes(lowerSearch)) {
                    row.style.display = 'grid';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        function filterMemoryType(type) {
            const rows = document.querySelectorAll('.memory-row');
            const buttons = document.querySelectorAll('.filter-button');

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            buttons.forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // è¿‡æ»¤æ˜¾ç¤º
            rows.forEach(row => {
                if (type === 'all') {
                    row.style.display = 'grid';
                } else {
                    if (row.dataset.type.toLowerCase() === type) {
                        row.style.display = 'grid';
                    } else {
                        row.style.display = 'none';
                    }
                }
            });
        }

        function readMemoryAddress(address) {
            if (!controller.selectedServoId) {
                alert('è¯·å…ˆé€‰æ‹©èˆµæœº');
                return;
            }

            // æ ¹æ®åœ°å€åˆ¤æ–­è¯»å–é•¿åº¦
            const memoryItem = controller.memoryMap.find(item => item.address === address);
            let readLength = 1; // é»˜è®¤è¯»å–1å­—èŠ‚

            // å¯¹äº16ä½å€¼çš„åœ°å€ï¼Œè¯»å–2å­—èŠ‚
            const doubleByteAddresses = [9, 10, 11, 12, 16, 17, 28, 29, 31, 32, 35, 36,
                                       42, 43, 44, 45, 46, 47, 48, 49, 56, 57, 58, 59, 60, 61, 67, 68];

            if (doubleByteAddresses.includes(address)) {
                readLength = 2;
            }

            controller.sendMessage({
                type: 'read_memory',
                servo_id: controller.selectedServoId,
                address: address,
                length: readLength
            });

            controller.addLog(`[å†…å­˜] è¯»å–åœ°å€: ${address.toString(16).toUpperCase()} (${readLength}å­—èŠ‚)`, 'info');
        }

        function writeMemoryAddress(address) {
            if (!controller.selectedServoId) {
                alert('è¯·å…ˆé€‰æ‹©èˆµæœº');
                return;
            }

            const memoryItem = controller.memoryMap.find(item => item.address === address);
            let promptText = `å†™å…¥åœ°å€ ${address.toString(16).toUpperCase()}`;
            let inputType = 'decimal';

            if (memoryItem) {
                promptText += ` - ${memoryItem.name}`;

                // æ ¹æ®å‚æ•°ç±»å‹ç»™å‡ºæ›´å…·ä½“çš„æç¤º
                if (memoryItem.name.includes('ç”µå‹')) {
                    promptText += '\nè¯·è¾“å…¥ç”µå‹å€¼ (å•ä½: 0.1V, ä¾‹å¦‚: 120 è¡¨ç¤º12.0V)';
                } else if (memoryItem.name.includes('æ¸©åº¦')) {
                    promptText += '\nè¯·è¾“å…¥æ¸©åº¦å€¼ (å•ä½: Â°C, èŒƒå›´: 0-100)';
                } else if (memoryItem.name.includes('ä½ç½®')) {
                    promptText += '\nè¯·è¾“å…¥ä½ç½®å€¼ (èŒƒå›´: 0-4095)';
                } else if (memoryItem.name.includes('æ—¶é—´') || memoryItem.name.includes('ms')) {
                    promptText += '\nè¯·è¾“å…¥æ—¶é—´å€¼ (å•ä½: ms)';
                } else {
                    promptText += '\nè¯·è¾“å…¥åè¿›åˆ¶æ•°å€¼';
                }
            }

            const value = prompt(promptText);
            if (!value) return;

            // éªŒè¯è¾“å…¥
            let numericValue = parseInt(value);
            if (isNaN(numericValue)) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å€¼');
                return;
            }

            // æ ¹æ®åœ°å€ç±»å‹è¿›è¡Œæ•°å€¼è½¬æ¢
            let writeData = numericValue;
            let displayValue = numericValue.toString();

            if (memoryItem) {
                // ç”µå‹å€¼ï¼šéœ€è¦è½¬æ¢ä¸º0.1Vå•ä½
                if (memoryItem.name.includes('ç”µå‹')) {
                    writeData = Math.round(numericValue / 0.1);
                    displayValue = numericValue.toFixed(1) + 'V';
                }
                // æ¸©åº¦å€¼ï¼šç›´æ¥ä½¿ç”¨
                else if (memoryItem.name.includes('æ¸©åº¦')) {
                    if (numericValue < 0 || numericValue > 100) {
                        alert('æ¸©åº¦å€¼å¿…é¡»åœ¨0-100Â°CèŒƒå›´å†…');
                        return;
                    }
                    displayValue = numericValue + 'Â°C';
                }
                // ä½ç½®å€¼ï¼šæ£€æŸ¥èŒƒå›´
                else if (memoryItem.name.includes('ä½ç½®')) {
                    if (numericValue < 0 || numericValue > 4095) {
                        alert('ä½ç½®å€¼å¿…é¡»åœ¨0-4095èŒƒå›´å†…');
                        return;
                    }
                    displayValue = numericValue + ' (0-4095)';
                }
                // PIDå¢ç›Šå€¼ï¼šæ£€æŸ¥èŒƒå›´
                else if (memoryItem.name.includes('å¢ç›Š')) {
                    if (numericValue < 0 || numericValue > 255) {
                        alert('PIDå¢ç›Šå€¼å¿…é¡»åœ¨0-255èŒƒå›´å†…');
                        return;
                    }
                }
            }

            // æ£€æŸ¥æ˜¯å¦éœ€è¦è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„ï¼ˆ16ä½å€¼ï¼‰
            const doubleByteAddresses = [9, 10, 11, 12, 16, 17, 28, 29, 31, 32, 35, 36,
                                       42, 43, 44, 45, 46, 47, 48, 49, 56, 57, 58, 59, 60, 61, 67, 68];

            let sendData;
            if (doubleByteAddresses.includes(address) && writeData <= 65535) {
                // è½¬æ¢ä¸ºå°ç«¯åºå­—èŠ‚æ•°ç»„
                sendData = [writeData & 0xFF, (writeData >> 8) & 0xFF];
            } else if (writeData <= 255) {
                // å•å­—èŠ‚
                sendData = [writeData];
            } else {
                alert('æ•°å€¼è¶…å‡ºèŒƒå›´');
                return;
            }

            controller.sendMessage({
                type: 'write_memory',
                servo_id: controller.selectedServoId,
                address: address,
                data: sendData
            });

            controller.addLog(`[å†…å­˜] å†™å…¥åœ°å€ ${address.toString(16).toUpperCase()}: ${displayValue}`, 'info');
        }

        // ä¸ºcontrollerå®ä¾‹æ·»åŠ æ–¹æ³•
        SeeedRoboCoreController.prototype.getServoStatus = function(servoId) {
            this.sendMessage({
                type: 'get_servo_status',
                servo_id: servoId
            });
        };

        SeeedRoboCoreController.prototype.getTemperatureLimit = function(servoId) {
            this.sendMessage({
                type: 'read_temperature_limit',
                servo_id: servoId
            });
        };
    </script>
</body>
</html>